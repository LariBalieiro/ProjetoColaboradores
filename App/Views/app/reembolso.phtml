<?php include("_nav.phtml") ?>

<div class="container mt-5 pt-4">
    <button onclick="history.back()" class="btn btn-primary mb-3">
        <i class="fas fa-arrow-left"></i> Voltar
    </button>
    <div class="card shadow-sm p-4 mx-auto" style="max-width: 900px; border-radius: 12px; background-color: #f9f9f9;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4 class="mb-0">Lista de Reembolsos</h4>
            <a class="btn btn-success" data-bs-toggle="modal" data-bs-target="#reembolsoModal">
                + Solicitar Reembolso
            </a>
        </div>

        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
                <thead class="table-primary">
                    <tr>
                        <th>Data</th>
                        <th>Tipo</th>
                        <th>Valor</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <?php if (!empty($this->view->reembolsos)): ?>
                        <?php foreach ($this->view->reembolsos as $index => $reembolso): ?>
                            <tr>
                                <td>
                                    <?= htmlspecialchars(date('d/m/Y', strtotime($reembolso['Reembolso_Data']))) ?>
                                </td>
                                <td><?= htmlspecialchars($reembolso['Reembolso_Tipo']) ?></td>
                                <td>R$ <?= number_format($reembolso['Reembolso_Valor'], 2, ',', '.') ?></td>
                                <td>
                                    <?php if ($reembolso['Reembolso_Resposta'] === 'Aprovado'): ?>
                                        <span class="badge bg-success">Aprovado</span>
                                    <?php elseif ($reembolso['Reembolso_Resposta'] === 'Enviado'): ?>
                                        <span class="badge bg-warning text-dark">Enviado</span>
                                    <?php elseif ($reembolso['Reembolso_Resposta'] === 'Em Análise'): ?>
                                        <span class="badge bg-warning text-dark">Em Análise</span>
                                    <?php else: ?>
                                        <span class="badge bg-danger">Reprovado</span>
                                    <?php endif; ?>
                                </td>
                            </tr>
                        <?php endforeach; ?>
                    <?php else: ?>
                        <tr>
                            <td colspan="4" class="text-center text-muted">Nenhum reembolso encontrado</td>
                        </tr>
                    <?php endif; ?>
                </tbody>
            </table>
        </div>
    </div>
</div>

<?php include("modalReembolso.phtml"); ?>